<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cursoDAgil.bd.mappers.ClienteMapper">
	<resultMap id="BaseResultMap" type="cursoDAgil.bd.domain.Cliente">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 11 
			17:37:33 CST 2021. -->
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="nombre" jdbcType="VARCHAR" property="nombre" />
		<result column="apellido" jdbcType="VARCHAR" property="apellido" />
		<result column="email" jdbcType="VARCHAR" property="email" />
		<result column="sexo" jdbcType="VARCHAR" property="sexo" />
		<result column="idDireccion" jdbcType="INTEGER" property="idDireccion" />
	</resultMap>

	<resultMap id="ResultClienteDireccion" type="cursoDAgil.bd.domain.Cliente">
		<id column="id" property="id" />
		<result column="nombre" jdbcType="VARCHAR" property="nombre" />
		<result column="apellido" jdbcType="VARCHAR" property="apellido" />
		<result column="email" jdbcType="VARCHAR" property="email" />
		<result column="sexo" jdbcType="VARCHAR" property="sexo" />
		<result column="idDireccion" jdbcType="INTEGER" property="idDireccion" />
		<association property="direccion" column="idDireccion"
			resultMap="DireccionResultMap" />
	</resultMap>

	<resultMap id="DireccionResultMap" type="cursoDAgil.bd.domain.Direccion">
		<id column="idDireccion" property="idDireccion" />
		<result column="calle" property="calle" />
		<result column="numero" property="numero" />
		<result column="colonia" property="colonia" />
		<result column="ciudad" property="ciudad" />
		<result column="estado" property="estado" />
		<result column="pais" property="pais" />
		<result column="codigoPostal" property="codigoPostal" />
	</resultMap>

	<select id="listarTodosClientes" resultMap="ResultClienteDireccion">
		SELECT cli.id, cli.nombre, cli.apellido, cli.email, cli.sexo, cli.idDireccion, 
		d.idDireccion, d.calle, d.numero, d.colonia, d.ciudad, d.estado, 
		d.pais, d.codigoPostal 
		FROM cliente cli INNER JOIN direccion AS d ON cli.idDireccion = d.idDireccion
	</select>
	<insert id="agregarCliente" parameterType="cursoDAgil.bd.domain.Cliente"
			useGeneratedKeys="true" keyProperty="idCliente">
	
		INSERT INTO cliente(nombre, apellido, email, sexo, idDireccion) VALUES (#{nombre},#{apellido},#{email},#{sexo},#{idDireccion})
	</insert>
	
	<delete id="eliminarCliente" parameterType="hashMap">
		DELETE FROM cliente WHERE id= #{id}
	</delete>
	<update id="actualizaCliente" parameterType="cursoDAgil.bd.domain.Cliente">
		UPDATE cliente SET nombre=#{nombre}, apellido=#{apellido},email=#{email}, sexo=#{sexo},idDireccion=#{idDireccion} WHERE id=#{id}
	</update>
	<select id="obtenerClientePorId" resultMap="ResultClienteDireccion">
		SELECT cli.id, cli.nombre, cli.apellido, cli.email, cli.sexo, cli.idDireccion, 
		d.idDireccion, d.calle, d.numero, d.colonia, d.ciudad, d.estado, 
		d.pais, d.codigoPostal 
		FROM cliente cli INNER JOIN direccion AS d ON cli.idDireccion = d.idDireccion WHERE cli.id=#{id}	
	</select>

</mapper>
